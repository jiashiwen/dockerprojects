# v1.2 版本的移动前台功能接口


# v1.2 版本的前台功能接口

>    V1.0 @2017-04-18 给移动端首页补充一个热门问答的获取接口
>    V1.0 @2017-04-13 添加移动端个人中心页面的各列表 加载更多 接口，栏目列表页、标签聚合页以及搜索结果页列表中的下接加载接口
>    V1.0 @2017-04-10 添加提问表单接口和回答问题接口
>	V1.0 @2017-03-29 给 关注接口 添加参数 act 用于判断是关注还是取消关注
>	V1.0 @2017-03-29 整理 By Robert

### 移动端前台的加载更多的分页接口

#### 首页热门问答列表

- 接口地址 : /api/hotq
- 传参方式 : GET
- 接口参数 :
     - page : 指定分页代码 从 2 开始。因为第 1 页已经随页面进行加载了
- 更新时间 : 2017-04-18
- 例子 :
```
$.ajax({
     url: '/api/hotq',
     cache: false,
     data: { page:2 },
     success:function(d){
          console.log(d);
     }
});
```

#### 个人中心页各列表的分页获取

- 接口地址 : /profile/page/
- 传参方式 : GET
- 接口参数 :
     - column : 指定个人中心中的栏目代码
          - recommends 对应 我的推荐
          - questions 对应 我的问题
          - answers 对应 我的回答
          - attentions 对应 我的关注
          - todo 对应 待我解决
     - page : 指定分页代码 从 2 开始。因为第 1 页已经随页面进行加载了
- 更新时间 : 2017-04-13
- 例子 :
```
$.ajax({
     url: '/profile/page/',
     cache: false,
     data: { column:'todo', page:2 },
     success:function(d){
          console.log(d);
     }
});
```
- 结果列表 : (只说明重要部份)
```
{
    "columns": { ... },
    "current": "todo",
    "userinfo": {
        "uid": "20000000266986",
        "username": "爱在深秋",
        "isThird": false,
        "phone": "186****5264",
        "headurl": "http://src.leju.com/imp/imp/deal/07/2c/a/ed9ce631da59ad2ef7f35e3d5a1_p36_mk35_c601X601X0X0X.jpg",
        "sinaid": "",
        "iscard": true
    },
    "config": { ... },
    "pager": {
        "page": 3,  // 当前访问的页码
        "pagesize": 5, // 每页返回的数据条数
        "total": 16, // 总共有多少条数据
        "count": 4, // 总页数
        "hasnext": 1 // 特别提供给异步加载更多使用的，用于判断是否还有下一页，如果仍可以加载为1，不能再加载为0
    },
    "list": [ // 数据列表
          {
              "id": "42022",
              "title": "问点啥好呢？", // 问题标题
              "tags": "测试 注入 开发",
              "scope": "bj",
              "catepath": "0-",
              "ctime": "1473659512",    // 提问时间
              "cateid": "0",
              "anonymous": "1",    // 是否匿名提问
              "usernick": "乐居网友",      // 用户昵称
              "i_hits": "1",            // 问题的访问量
              "i_replies": "1",         // 问题回复数
              "i_attention": "0",       // 问题的关注数
              "tagsinfo": {             // 标签列表
                  "开发": {
                      "id": "18102",
                      "name": "开发",
                      "url": "http://ld.m.ask.leju.com/tag18102/"     // 标签聚合页链接地址
                  }
              },
              "catenamepath": false,    // 问题如果未归类，为false, 如果已经归类，则为一个对象 如 {"182": "问题测试1","188": "问题测试abc"}，表示为多级栏目的相关信息，栏目地址拼接规则为 "/list{k}/" 比如 上面这
              "dsp_time": "09-12", // 用于显示的时间
              "url": "http://ld.m.ask.leju.com/42022.html"  // 详情页的链接地址
          }, ...
     ]
}
```

#### 栏目列表页下拉加载更多接口

- 接口地址 : /list/page/
- 传参方式 : GET
- 接口参数 :
     - id : 指定栏目编号
     - page : 指定分页代码 从 2 开始。因为第 1 页已经随页面进行加载了
- 更新时间 : 2017-04-13
- 调用位置 : 移动端 栏目列表页 url 模式 /list{id}
- 例子 :
```
$.ajax({
     url: '/list/page/',
     cache: false,
     data: { id:188, page:2 },
     success:function(d){
          console.log(d);
     }
});
```

#### 标签聚合页列表页下拉加载更多接口

- 接口地址 : /agg/page/
- 传参方式 : GET
- 接口参数 :
     - id : 指定标签编号
     - page : 指定分页代码 从 2 开始。因为第 1 页已经随页面进行加载了
- 更新时间 : 2017-04-13
- 调用位置 : 移动端 标签聚合页 url 模式 /tag{id}
- 例子 :
```
$.ajax({
     url: '/agg/page/',
     cache: false,
     data: { id:16320, page:2 },
     success:function(d){
          console.log(d);
     }
});
```

#### 搜索结果页列表页下拉加载更多接口

- 接口地址 : /search/page/
- 传参方式 : GET
- 接口参数 :
     - k : 搜索关键词
     - page : 指定分页代码 从 2 开始。因为第 1 页已经随页面进行加载了
- 调用位置 : 移动端 搜索结果页 url 模式 /search/?k=id
- 更新时间 : 2017-04-13
- 例子 :
```
$.ajax({
     url: '/search/page/',
     cache: false,
     data: { k:'房', page:2 },
     success:function(d){
          console.log(d);
     }
});
```

----

### 提问页面表单接口

- 表单地址 : /ask/save
- 传参方式 : POST
- 接口参数 :
     - title => 提问的摘要信息 必传
     - desc => 问题的描述信息 必传
     - tags => 问题的标签 每个标签使用 "," 分隔 必传
     - data_notice => 有回答时的提醒地址(可以是手机号也可以是电子邮箱，也可以为空)，默认为空 选填
     - anonymous => 是否匿名提问 默认为0，表示正常提问，1为匿名提问 选填
     - images => 是否上传提问图片 此处为一数组，如果只有一张图片，此参数即为 1 个元素的数组 选填
- 调用位置 : 首页, 提问页, 列表页
- 更新时间 : 2017-04-10


### 猜你喜欢数据接口

- 接口地址 : /api/guess
- 传参方式 : GET
- 接口参数 : 无
- 调用位置 : 首页, 提问页, 列表页
- 例子 :
```
$.ajax({
     url:'/api/guess',
     cache: false,
     success:function(d){
          console.log(d);
     }
});
```

### 联想词数据接口

- 接口地址 : /api/suggest
- 传参方式 : GET
- 接口参数 :
     - k => 联想词 必传
- 调用位置 : 所有搜索框, 提问页标题框
- 例子 :
```
$.ajax({
     url:'/api/suggest',
     cache: false,
     data: {k:'房'},
     success:function(d){
          console.log(d);
     }
});
```

### 相关知识数据接口

- 接口地址 : /api/relations
- 传参方式 : GET
- 接口参数 :
     - tag => 标签编号 必传
- 调用位置 : 正文页
- 例子 :
```
$.ajax({
     url:'/api/relations',
     cache: false,
     data: {tag:123},
     success:function(d){
          console.log(d);
     }
});
```

### 标签联想数据接口

- 接口地址 : /api/tag
- 传参方式 : GET
- 接口参数 :
     - k => 标签名称 必传
- 调用位置 : 提问页
- 例子 :
```
$.ajax({
     url:'/api/tag',
     cache: false,
     data: {k:'房'},
     success:function(d){
          console.log(d);
     }
});
```

### 关注问题操作接口

- 接口地址 : /api/attention
- 传参方式 : GET
- 接口参数 :
     - qid => 问题编号 必传
     ~~- act => 关注动作 1为关注 0为取消关注~~
- 调用位置 : 正文页
- 例子 :
```
$.ajax({
     url:'/api/attention',
     cache: false,
     ~~data: {qid:1234,act:1},~~
     data: {qid:1234},
     success:function(d){
          console.log(d);
     }
});
```

### 答案点赞操作接口

- 接口地址 : /api/good
- 传参方式 : GET
- 接口参数 :
     - aid => 问题答案的编号 必传
- 调用位置 : 正文页
- 例子 :
```
$.ajax({
     url:'/api/good',
     cache: false,
     data: {aid:1234},
     success:function(d){
          console.log(d);
     }
});
```

### 设置最佳答案操作接口

- 接口地址 : /api/best
- 传参方式 : GET
- 接口参数 :
     - aid => 问题答案的编号 必传
- 调用位置 : 正文页 (前台只有提问者自己可以触发)
- 例子 :
```
$.ajax({
     url:'/api/best',
     cache: false,
     data: {aid:1234},
     success:function(d){
          console.log(d);
     }
});
```

### 对指定问题进行回答

- 接口地址 : /api/reply
- 传参方式 : POST
- 接口参数 :
     - qid => 问题编号 必传
     - reply => 问题的答案内容 必传
     - anonymous => 是否匿名回答 默认为0，表示正常回答，1为匿名回答 选填
- 调用位置 : 正文页 (前台只有提问者自己可以触发)
- 更新时间 : 2017-04-10
- 例子 :
```
$.ajax({
   url: '/api/reply',
   method: 'post',
   data: {qid:42038,reply:'123456',anonymous:1},
   success: function(data) {
      console.log(data);
    }
})
```



# v1.2版本的后台功能接口

>	V1.0 @2017-02-28 By Robert

- 知识系统 - 问答子系统栏目功能模块的重构已完成

## 栏目类

### 知识栏目管理入口

/Cate/Knowledge

### 问答栏目管理入口

/Cate/Question


### 获取栏目信息

- 接口地址 : /Cate/info
- 传参方式 : GET
- 接口参数 :
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
     - id => 栏目编号id `必传`
     - type =>
- 例子 :

```
$.ajax({
     url:'/Cate/info',
     /* method: 'GET', */
     cache: false,
     data:{id:182,type:qa},
     success:function(d){
          console.log(d);
     }
});
```

### 创建栏目信息

- 接口地址 : /Cate/add
- 传参方式 : POST
- 接口参数 :
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
     - id => 父栏目编号id `必传`
     - name => 问答栏目名称 `必传`
     - code => 问答栏目代码 `必传`
- 例子 :

```
$.ajax({
     url: '/Cate/add',
     method: 'POST',
     cache: false,
     data: {id:182, type:'qa',name:'问题测试abc',code:'qatestddl'},
     success:function(d){
          console.log(d);
     }
});
```

### 修改栏目信息

- 接口地址 : /Cate/edit
- 传参方式 : POST
- 接口参数 :
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
     - id => 父栏目编号id `必传`
     - name => 问答栏目名称 `必传`
     - code => 问答栏目代码 `必传`
- 例子 :

```
$.ajax({
     url: '/Cate/edit',
     method: 'POST',
     cache: false,
     data: {id:185, type:'qa', name:'问题测试123', code:'qatestabc'},
     success:function(d){
          console.log(d);
     }
});
```

### 栏目位置交换

- 接口地址 : /Cate/exchange
- 传参方式 : POST
- 接口参数 :
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
     - oid => 要交换位置栏目原始编号 `必传`
     - nid => 要交换位置栏目目标编号 `必传`
- 例子 :

```
$.ajax({
     url: '/Cate/exchange',
     method: 'POST',
     cache: false,
     data: {type:'qa',oid:187,nid:188},
     success: function(d){
          console.log(d);
     }
});
```

### 栏目显示状态切换

- 接口地址 : /Cate/onoff
- 传参方式 : POST
- 接口参数 :
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
     - id => 要切换显示状态的栏目编号 `必传`
- 例子 :

```
$.ajax({
     url: '/Cate/onoff',
     method: 'POST',
     cache: false,
     data: {type:'qa',id:188},
     success: function(d){
          console.log(d);
     }
});
```


### 删除栏目

- 接口地址 : /Cate/destory
- 传参方式 : POST
- 接口参数 :
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
     - id => 要切换显示状态的栏目编号 `必传`
- 例子 :

```
$.ajax({
     url: '/Cate/destory',
     method: 'POST',
     cache: false,
     data: {type:'qa',id:189},
     success: function(d){
          console.log(d);
     }
});
```


### 异步加载栏目列表

- 接口地址 : /Cate/getcates
- 传参方式 : GET
- 接口参数 :
     - id => 指定要加载的父栏目编号 0表示根栏目 `必传`
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
     - all => 是否返回所有子栏目 1表示返回 默认或不传表示不返回
- 例子 :

```
$.ajax({
     url:'/Cate/getcates',
     cache: false,
     data:{id:0,type:'qa',all:1},
     success:function(d){
          console.log(d);
     }
});
```


### [管理使用] 后台强制重建栏目树缓存数据

- 接口地址 : /Cate/rebuildtree
- 传参方式 : GET
- 接口参数 :
     - type => 'qa'代表问答栏目 或 'kb'代表知识栏目 `必传`
- 例子 :

```
$.ajax({
     url:'/Cate/rebuildtree',
     cache: false,
     data:{type:'qa'},
     success:function(d){
          console.log(d);
     }
});
```


----

# 问答管理列表 相关接口

## 问题类

### 读取问题详情

- 接口地址 : /Question/info
- 传参方式 : GET
- 接口参数 :
     - qid => 指定要读取的问题编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/info',
     cache: false,
     data:{qid:42034},
     success:function(d){
          console.log(d);
     }
});
```

### 更新问题详情

- 接口地址 : /Question/save
- 传参方式 : POST
- 接口参数 :
     - qid => 指定要更新的问题编号 `必传`
     - catepath => 指定栏目编号路径 格式 0-一级栏目id-二级栏目id
     - tags => 标签名称列表 (后台最多可以设置6个) 格式，标签1,标签2,标签3 (每个标签之间通过半角逗号,分隔)
     - title => 问题标题
- 例子 :

```
$.ajax({
     url:'/Question/save',
     method: 'POST',
     cache: false,
     data:{qid:42034, catepath:'0-182-188'},
     success:function(d){
          console.log(d);
     }
});
```

### 获取问题待审核原因

- 接口地址 : /Question/notice
- 传参方式 : GET
- 接口参数 :
     - qid => 待审核问题编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/notice',
     cache: false,
     data:{qid:42034},
     success:function(d){
          console.log(d);
     }
});
```

### 推荐问题

- 接口地址 : /Question/recommend
- 传参方式 : GET
- 接口参数 :
     - qid => 待审核问题编号 `必传`
     - act => 推荐类型 focus 首页焦点图 unfocus 取消首页焦点图`必传`
     - imgSrc => 图片上传后的网络地址 当 act==focus 时 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/recommend',
     method: 'POST',
     cache: false,
     data:{qid:42034,act:'focus',imgSrc:'123'},
     success:function(d){
          console.log(d);
     }
});
```

```
$.ajax({
     url:'/Question/recommend',
     method: 'POST',
     cache: false,
     data:{qid:42033,act:'unfocus'},
     success:function(d){
          console.log(d);
     }
});
```

### 删除问题

- 接口地址 : /Question/remove
- 传参方式 : GET
- 接口参数 :
     - qid => 待删除的问题编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/remove',
     cache: false,
     data:{qid:42034},
     success:function(d){
          console.log(d);
     }
});
```

### 恢复问题

- 接口地址 : /Question/restore
- 传参方式 : GET
- 接口参数 :
     - qid => 待恢复的问题编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/restore',
     cache: false,
     data:{qid:42034},
     success:function(d){
          console.log(d);
     }
});
```

### 审核问题

- 接口地址 : /Question/verify
- 传参方式 : GET
- 接口参数 :
     - qid => 待审核通过的问题编号 `必传`
- 例子 : 
```
$.ajax({
     url:'/Question/verify',
     cache: false,
     data:{qid:42026},
     success:function(d){
          console.log(d);
     }
});
```

### 确认导入问题

- 接口地址 : /Question/confirm
- 传参方式 : GET
- 接口参数 :
     - qid => 待导入通过的问题编号 `必传`
- 例子 : 
```
$.ajax({
     url:'/Question/confirm',
     cache: false,
     data:{qid:42029},
     success:function(d){
          console.log(d);
     }
});
```

### 推荐问题

- 接口地址 : /Question/recommend
- 传参方式 : POST
- 接口参数 :
     - qid => 待审核通过的问题编号 `必传`
- 例子 : 
```
$.ajax({
     url:'/Question/recommend',
     method: 'POST',
     cache: false,
     data:{qid:42034,act:'focus',mgSrc:'http://src.leju.com/imp/imp/deal/9a/fc/0/8def7043264951d4ba38d2e88a4_p58_mk61.jpg'},
     success:function(d){
          console.log(d);
     }
});
```

----

## 回答类

### 读取指定问题的所有回答列表

- 接口地址 : /Question/answers
- 传参方式 : GET
- 接口参数 :
     - qid => 指定要读取的问题编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answers',
     cache: false,
     data:{qid:42016},
     success:function(d){
          console.log(d);
     }
});
```

### 删除指定回答

- 接口地址 : /Question/answer_delete
- 传参方式 : GET
- 接口参数 :
     - aid => 指定要删除的回复编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_delete',
     cache: false,
     data:{aid:51736},
     success:function(d){
          console.log(d);
     }
});
```

### 恢复指定回答

- 接口地址 : /Question/answer_restore
- 传参方式 : GET
- 接口参数 :
     - aid => 指定要恢复的回复编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_restore',
     cache: false,
     data:{aid:51736},
     success:function(d){
          console.log(d);
     }
});
```

### 指定回答置顶

- 接口地址 : /Question/answer_ontop
- 传参方式 : GET
- 接口参数 :
     - aid => 指定要置顶的回复编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_ontop',
     cache: false,
     data:{aid:51736},
     success:function(d){
          console.log(d);
     }
});
```

### 取消指定回答置顶

- 接口地址 : /Question/answer_untop
- 传参方式 : GET
- 接口参数 :
     - aid => 指定要取消置顶的回复编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_untop',
     cache: false,
     data:{aid:51736},
     success:function(d){
          console.log(d);
     }
});
```

### 采纳问题回复

- 接口地址 : /Question/answer_best
- 传参方式 : GET
- 接口参数 :
     - qid => 待采纳的回复所属问题编号 `必传`
     - aid => 待采纳的回复编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_best',
     cache: false,
     data:{aid:51796},
     success:function(d){
          console.log(d);
     }
});
```

### [x] 获取问题回复待审核原因

- 接口地址 : /Question/answer_notice
- 传参方式 : GET
- 接口参数 :
     - aid => 待审核问题回答编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_notice',
     cache: false,
     data:{aid:51736},
     success:function(d){
          console.log(d);
     }
});
```

### 审核问题回复

- 接口地址 : /Question/answer_verify
- 传参方式 : GET
- 接口参数 :
     - aid => 待审核通过的问题回复编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_verify',
     cache: false,
     data:{aid:51803},
     success:function(d){
          console.log(d);
     }
});
```

### 确认导入问题回复

- 接口地址 : /Question/answer_confirm
- 传参方式 : GET
- 接口参数 :
     - aid => 待审核通过的问题回复编号 `必传`
- 例子 :

```
$.ajax({
     url:'/Question/answer_confirm',
     cache: false,
     data:{aid:51803},
     success:function(d){
          console.log(d);
     }
});
```
